function BlogService(n,t){var i=n("",{},{get:{method:"GET",url:"/api/blog"},create:{method:"POST",url:"api/blog"},getById:{method:"GET",url:"/api/blog/:id"},update:{method:"PUT",url:"/api/blog/:id"}});return{get:function(){var n=t.defer();return i.get({},{},function(t){n.resolve(t)},function(t){n.reject(t)}),n.promise},create:function(n){var r=t.defer();return i.create({},n,function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},getById:function(n){var r=t.defer();return i.getById({id:n},{},function(n){r.resolve(n)},function(n){r.reject(n)}),r.promise},update:function(n,r){var u=t.defer();return i.update({id:n},r,function(n){u.resolve(n)},function(n){u.reject(n)}),u.promise}}}function PostListController(n,t){t.get().then(function(t){n.posts=t.posts})}function PostNewController(n,t){n.editorOptions={mode:"gfm",styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0};n.postBodyChanged=function(){window.searchTime!=null&&window.clearTimeout(searchTime);window.searchTime=window.setTimeout(function(){n.post.htmlBody=marked(n.post.body);n.$apply()},200)};n.create=function(){if(n.post.title==null||n.post.title.length==0){alert("填写文章标题");return}if(n.post.ename==null||n.post.title.ename==0){alert("填写文章路径");return}if(n.post.body==null||n.post.body.length==0){alert("请填写正文");return}var i={blog:n.post,version:12345};t.create(i).then(function(n){console.log(n)})}}function PostEditController(n,t,i,r){n.id=i.id;n.id||t.go("app.post.post-list");r.getById(n.id).then(function(i){i.status==404?t.go("app.post.post-list"):n.post=i.blog});n.editorOptions={mode:"gfm",styleActiveLine:!0,lineNumbers:!0,lineWrapping:!0};n.postBodyChanged=function(){window.searchTime!=null&&window.clearTimeout(searchTime);window.searchTime=window.setTimeout(function(){n.post.htmlBody=marked(n.post.body);n.$apply()},200)};n.create=function(){if(n.post.title==null||n.post.title.length==0){alert("填写文章标题");return}if(n.post.ename==null||n.post.title.ename==0){alert("填写文章路径");return}if(n.post.body==null||n.post.body.length==0){alert("请填写正文");return}var t={blog:n.post,version:67890};r.update(n.id,t).then(function(n){console.log(n)})}}var route=function(n,t){t.when("","/welcome").when("/","/welcome");n.state("app",{url:"/",views:{header:{templateUrl:"/scripts/views/view_header.html"},menu:{templateUrl:"/scripts/views/view_menu.html"},"main-body":{template:"<div ui-view><div>"}}});n.state("app.welcome",{url:"welcome",templateUrl:"/scripts/views/view_welcome.html?v="+window.version});n.state("app.post",{});n.state("app.post.post-list",{url:"post-list",templateUrl:"/scripts/views/view_post_list.html?v="+window.version,controller:PostListController});n.state("app.post.post-new",{url:"post-new",templateUrl:"/scripts/views/view_post_new.html?v="+window.version,controller:PostNewController});n.state("app.post.post-edit",{url:"post-edit/:id",templateUrl:"/scripts/views/view_post_edit.html?v="+window.version,controller:PostEditController})},app=angular.module("app",["ngResource","ui.router","ui.bootstrap","ui.codemirror"]);app.config(route);app.service("BlogService",["$resource","$q",BlogService]);